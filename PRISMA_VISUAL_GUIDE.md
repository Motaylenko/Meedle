# 🎨 Prisma Workflow - Візуальний гайд

## 📊 Процес інтеграції Prisma

```
┌─────────────────────────────────────────────────────────────────────┐
│                     PRISMA INTEGRATION WORKFLOW                      │
└─────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────┐
│  КРОК 1: ВСТАНОВЛЕННЯ                                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  npm install  →  npm install prisma @prisma/client                  │
│                                                                      │
│  ✅ Встановлено Prisma CLI та Client                                │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  КРОК 2: КОНФІГУРАЦІЯ                                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  📝 schema.prisma  →  Визначення моделей даних                      │
│  🔐 .env          →  DATABASE_URL                                   │
│                                                                      │
│  ✅ Схема БД готова                                                 │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  КРОК 3: ГЕНЕРАЦІЯ CLIENT                                           │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  npm run db:generate  →  Prisma Client згенеровано                  │
│                                                                      │
│  ✅ Type-safe API готове                                            │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  КРОК 4: СТВОРЕННЯ ТАБЛИЦЬ                                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  npm run db:push  →  Таблиці створені в PostgreSQL                  │
│                                                                      │
│  ✅ База даних готова                                               │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  КРОК 5: ЗАПОВНЕННЯ ДАНИМИ                                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  npm run db:seed  →  27 записів додано                              │
│                                                                      │
│  ✅ Тестові дані готові                                             │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
                                ↓
┌─────────────────────────────────────────────────────────────────────┐
│  КРОК 6: ЗАПУСК СЕРВЕРА                                             │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  node src/index-prisma.js  →  Server running on port 5000           │
│                                                                      │
│  ✅ API готове до використання                                      │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 🗄️ Структура бази даних

```
                    ┌──────────────────┐
                    │      USERS       │
                    │  (користувачі)   │
                    └────────┬─────────┘
                             │
              ┌──────────────┼──────────────┐
              │              │              │
              ▼              ▼              ▼
    ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
    │USER_SETTINGS│  │ ENROLLMENTS │  │   GRADES    │
    │(налаштування)│  │  (записи)   │  │  (оцінки)   │
    └─────────────┘  └──────┬──────┘  └──────┬──────┘
                            │                 │
                            │                 │
                            ▼                 ▼
                    ┌──────────────────┐
                    │     COURSES      │
                    │     (курси)      │
                    └────────┬─────────┘
                             │
              ┌──────────────┼──────────────┐
              │              │              │
              ▼              ▼              ▼
    ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
    │  SCHEDULES  │  │    TASKS    │  │ LEADERBOARD │
    │  (розклад)  │  │ (завдання)  │  │  (рейтинг)  │
    └─────────────┘  └─────────────┘  └─────────────┘
```

---

## 🔄 API Request Flow

```
┌──────────┐      ┌──────────┐      ┌──────────┐      ┌──────────┐
│          │      │          │      │          │      │          │
│  CLIENT  │─────▶│ EXPRESS  │─────▶│  PRISMA  │─────▶│POSTGRESQL│
│          │      │          │      │  CLIENT  │      │          │
└──────────┘      └──────────┘      └──────────┘      └──────────┘
     ▲                                                       │
     │                                                       │
     │                  ┌──────────┐                        │
     │                  │          │                        │
     └──────────────────│ RESPONSE │◀───────────────────────┘
                        │          │
                        └──────────┘

Приклад:
1. GET /api/courses
2. Express отримує запит
3. Prisma виконує: prisma.course.findMany()
4. PostgreSQL повертає дані
5. Відповідь відправляється клієнту
```

---

## 📁 Файлова структура

```
backend/
│
├── prisma/
│   ├── schema.prisma    ◄── Схема БД (8 моделей)
│   └── seed.js          ◄── Seed дані (27 записів)
│
├── src/
│   ├── prisma.js        ◄── Prisma Client
│   ├── index-prisma.js  ◄── Новий backend (450+ рядків)
│   └── index.js         ◄── Старий backend (резервна копія)
│
├── .env                 ◄── Змінні середовища
├── .env.example         ◄── Приклад конфігурації
└── package.json         ◄── Prisma скрипти
```

---

## 🎯 Команди Prisma

```
┌─────────────────────────────────────────────────────────────┐
│  РОЗРОБКА                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  npm run db:generate  →  Генерує Prisma Client              │
│  npm run db:push      →  Застосовує схему до БД             │
│  npm run db:seed      →  Заповнює БД даними                 │
│  npm run db:studio    →  Відкриває GUI для БД               │
│                                                              │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│  PRODUCTION                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  npm run db:migrate   →  Створює міграції                   │
│  npx prisma migrate deploy  →  Застосовує міграції          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 🔗 Зв'язки між таблицями

```
┌─────────────────────────────────────────────────────────────┐
│  ТИПИ ЗВВЯЗКІВ                                               │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1:1  (One-to-One)                                          │
│  User ←──────→ UserSettings                                 │
│                                                              │
│  1:M  (One-to-Many)                                         │
│  Course ←──────→ Schedule                                   │
│  Course ←──────→ Grade                                      │
│  Course ←──────→ Task                                       │
│                                                              │
│  M:N  (Many-to-Many)                                        │
│  User ←──Enrollment──→ Course                               │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 📊 Приклади запитів

```javascript
// 1. Отримати всіх користувачів
const users = await prisma.user.findMany();

// 2. Отримати користувача з налаштуваннями
const user = await prisma.user.findUnique({
  where: { id: 1 },
  include: { settings: true }
});

// 3. Отримати курси з студентами
const courses = await prisma.course.findMany({
  include: {
    enrollments: {
      include: { user: true }
    }
  }
});

// 4. Створити нове завдання
const task = await prisma.task.create({
  data: {
    title: 'Нове завдання',
    userId: 1,
    courseId: 1,
    deadline: new Date('2026-02-10')
  }
});

// 5. Оновити прогрес
await prisma.enrollment.update({
  where: { id: 1 },
  data: { progress: 85 }
});
```

---

## 🎨 Prisma Studio

```
┌─────────────────────────────────────────────────────────────┐
│  PRISMA STUDIO - GUI для бази даних                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Запуск:  npm run db:studio                                 │
│  URL:     http://localhost:5555                             │
│                                                              │
│  Можливості:                                                │
│  ✅ Перегляд всіх таблиць                                   │
│  ✅ Редагування записів                                     │
│  ✅ Додавання нових записів                                 │
│  ✅ Видалення записів                                       │
│  ✅ Фільтрація та пошук                                     │
│  ✅ Перегляд зв'язків                                       │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 🚀 Швидкий старт

```
┌─────────────────────────────────────────────────────────────┐
│  ШВИДКИЙ СТАРТ (3 ХВИЛИНИ)                                   │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. cd backend                                              │
│  2. npm install                                             │
│  3. npm run db:generate                                     │
│  4. npm run db:push                                         │
│  5. npm run db:seed                                         │
│  6. node src/index-prisma.js                                │
│                                                              │
│  ✅ Готово! API працює на http://localhost:5000             │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎯 Перевірка роботи

```
┌─────────────────────────────────────────────────────────────┐
│  ТЕСТУВАННЯ API                                              │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ✅ GET /api/health        →  Статус БД                     │
│  ✅ GET /api/courses       →  Список курсів                 │
│  ✅ GET /api/schedule      →  Розклад                       │
│  ✅ GET /api/grades        →  Оцінки                        │
│  ✅ GET /api/tasks         →  Завдання                      │
│  ✅ GET /api/user          →  Користувач                    │
│  ✅ GET /api/leaderboard   →  Рейтинг                       │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 📚 Документація

```
┌─────────────────────────────────────────────────────────────┐
│  ДОСТУПНА ДОКУМЕНТАЦІЯ                                       │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  📖 PRISMA_README.md       →  Короткий огляд                │
│  ⚡ PRISMA_QUICKSTART.md   →  Швидкий старт                 │
│  ✅ PRISMA_CHECKLIST.md    →  Чеклист                       │
│  🔧 PRISMA_COMMANDS.md     →  Команди                       │
│  📊 DATABASE_SCHEMA.md     →  Схема БД                      │
│  ❓ PRISMA_FAQ.md          →  36 питань                     │
│  📝 PRISMA_SETUP.md        →  Детальна інструкція           │
│  📁 PRISMA_STRUCTURE.md    →  Структура проєкту             │
│  📑 PRISMA_INDEX.md        →  Повний індекс                 │
│  🎉 PRISMA_COMPLETE.md     →  Підсумок                      │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## ✨ Готово!

**Ваш проєкт Meedle тепер використовує Prisma ORM!** 🎉

Почніть з: **[PRISMA_README.md](./PRISMA_README.md)** 🚀
